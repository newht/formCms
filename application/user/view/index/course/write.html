<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>教育报名系统</title>
    <link rel="stylesheet" href="/static/layui/css/layui.css">
    <link rel="stylesheet" href="/static/user/css/indexTable.css">
    <style>

        .info ul li input[type=button]{padding: 5px 15px}
    </style>
</head>
<body>
<div class="max">
    <div class="logo"></div>
    <div class="wlcome">
        <span class="wlcomeleft"><i class="layui-icon">&#xe66f; </i>欢迎您：胡涛</span>
        <span class="wlcomeright"><a href="/user/drop"><i class="layui-icon" >&#xe682; </i>退出</a></span>
    </div>
    <div class="info">
        <div class="infoTitle">
            {$form.fname}
        </div>
        <ul>
            <form>
                <input type="hidden" name="tb_name" value="{$form.tb_name}">
                {foreach $form.content as $k => $v}
                <li><div>
                    <label for="fie_{$k}">{$v.comment}</label>
                    {if $v.type == 'text'}
                    <input type="text" id="fie_{$k}" name="fie_{$k}" value="">
                    {/if}
                    {if $v.type == 'select'}
                    <select name="fie_{$k}" id="fie_{$k}">
                        {foreach $v.option as $m => $n}
                        <option value="{$n}">{$n}</option>
                        {/foreach}
                    </select>
                    {/if}
                    {if $v.type == 'checkbox'}
                    <div style="margin-top: 3px;display: block">
                        {foreach $v.label as $m => $n}
                        <input type="checkbox" name="fie_{$k}" id="checkbox_{$m}" value="{$n.label_chid_text}"><label for="checkbox_{$m}">{$n.label_chid_text}</label>
                        {/foreach}
                    </div>
                    {/if}
                    {if $v.type == 'radio'}
                    <div style="margin-top: 3px;display: block">
                        {foreach $v.label as $m => $n}
                        <input type="radio" name="fie_{$k}" value="{$n.label_chid_text}" id="radio_{$m}"><label for="radio_{$m}">{$n.label_chid_text}</label>
                        {/foreach}
                    </div>
                    {/if}
                    {if $v.type == 'textarea'}
                    <div style="margin-top: 3px;display: block;width: 100%">
                        <textarea name="fie_{$k}" id="fie_{$k}" rows="3"></textarea>
                    </div>
                    {/if}
                </div></li>
                {/foreach}
                <li><div><input type="button" id="submit" value="保存"></div></li>
            </form>
        </ul>
    </div>
</div>
<div class="webbottom">
    <ul>
        <li><div><a href="/user/index"><i class="layui-icon-user layui-icon" style="font-size: 30px"></i></a></div>个人信息</li>
        <li><div><a href="/user/signup"><i class="layui-icon-edit layui-icon" style="font-size: 30px"></i></a></div>课程报名</li>
        <li><div><a href="/user/gorecording"><i class="layui-icon-log layui-icon" style="font-size: 30px"></i></a></div>报名记录</li>
    </ul>
</div>
</body>
<script type="text/javascript" src="/static/jquery.min.js"></script>
<script type="text/javascript" src="/static/layui/layui.js"></script>
<script>
    layui.use('layer',function () {
        let layer = layui.layer;
    })
    $(function () {
        $('.info ul li:last').css('border',0);
        $("input").prop('autocomplete','off');

        $("#submit").click(function () {
            let obj = $(this);
            let data = $("form").serializeArray();
            for(let i=0 ; i<data.length ; i++ ){
                if(i > 1 && data[i].name === data[i-1].name ){
                    data[i].value += "," + data[i-1].value;
                }
                data[i].value = data[i].value.replace(/\s+/g, "");
            }
            $.ajax({
                url:"/user/insert",
                type:"post",
                dataType:"json",
                data:data,
                success:function(e){
                    if(e.code === 0){
                        layer.open({'title':'提示信息',btn:['确认'],content:'保存成功,点击确认返回上一级'});
                    }
                }
            })
        })
    })
</script>
</html>